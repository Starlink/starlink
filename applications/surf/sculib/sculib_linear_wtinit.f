      SUBROUTINE SCULIB_LINEAR_WTINIT (WTFN, RES, STATUS)
*+
*  Name:
*     SCULIB_LINEAR_WTINIT
*
*  Purpose:
*     Set up weighting function for linear rebinning
*
*  Language:
*     Starlink FORTRAN 77

*  Invocation:
*     CALL SCULIB_LINEAR_WTINIT(WTFN, RES, STATUS)

*  Description:
*     This is a FORTRAN version of the C transputer code.
*     Here is the C description:
*     Initialise the array containing the weighting function for
*     linear interpolation.
*     The weighting function is a cone, going from 1.0 at the centre to
*     0.0 at the edge. The look-up table represents a radial slice through the
*     cone, tabulated to enable a look-up in terms of the square of the
*     radius.

*  Arguments:
*     WTFN ( RES * RES ) = REAL (Returned)
*       The weighting function generated by this routine.
*       The index corresponds to the square of the distance from the
*       centre in scale units.
*     RES = INTEGER (Given)
*        Number of points per scale lenghth.
*     STATUS = INTEGER (Given & Returned)
*        Global status

*  Authors:
*     Tim Jenness (t.jenness@jach.hawaii.edu) - FORTRAN
*     B.D.Kelly (ROE)                         - Transputer


*  Copyright:
*     Copyright (C) 1995,1996,1997,1998,1999 Particle Physics and Astronomy
*     Research Council. All Rights Reserved.

*  History:
*     $Log$
*     Revision 1.4  1999/08/03 19:35:12  timj
*     Add copyright message to header.
*     Convert old header style to new.
*
*     Revision 1.3  1999/07/29 21:51:07  timj
*     Add History: tag to header.
*

*-

*  Type definitions
      IMPLICIT NONE

*  External constants:
      INCLUDE 'SAE_PAR'

*  Arguments Given:
      INTEGER STATUS
      INTEGER RES                        ! Resolution of lookup

*  Arguments Given & Returned:
      REAL WTFN(RES * RES)

*  Local variables:
      INTEGER I                          ! Counter

*  Local Data:

*.

      IF (STATUS .NE. SAI__OK) RETURN

      DO I = 1, RES * RES

         WTFN(I) = 1.0 - SQRT(REAL(I-1)) / REAL(RES)

      END DO

      END

