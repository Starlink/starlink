#!/bin/sh -

top=..

# Little script to propagate the version stored in the file VERSION.  The
# version strings to be replaced must either be on a line which
# includes the string %%VERSION%% (probably in a comment) or comes
# immediately after such a line.  It must also be the first string
# which matches the regexp.

for f in $top/dsssl/sl/common/slparams.dsl $top/makefile; do
    if test $top/VERSION -nt $f; then
	sed '/%%VERSION%%/{N;s/[0-9][0-9.-]\+[a-z]*/'`cat $top/VERSION`'/;}' \
		$f >tmp-file && mv tmp-file $f
    fi
done

